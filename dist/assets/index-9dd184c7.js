var Me=Object.defineProperty;var Oe=(n,t,s)=>t in n?Me(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var T=(n,t,s)=>(Oe(n,typeof t!="symbol"?t+"":t,s),s);import{r as i,j as e,R as $e}from"./react-1c86ef5d.js";import{c as ze}from"./react-dom-534b76c5.js";import{I as De,a as ve,b as Le,c as N,d as I,e as A,f,g as b,h as ke,i as be,j as he,k as we,l as C,m as S,n as g,o as xe,p,q as v,r as ae,s as ie,t as te,u as L,v as B,w as Ge,x as We,y as se,z as Ie,A as Ye,B as Je,C as Qe,D as Ze}from"./@ionic-4860044d.js";import{u as J,b as P,R as y}from"./react-router-f66ee0a0.js";import{m as $}from"./mapbox-gl-93c45937.js";import{a as qe}from"./axios-f9cbc706.js";import{u as ye}from"./react-resize-detector-c224a3ef.js";import{L as Ne,a as Ae,C as Re,X as Be,Y as Te,T as Ce}from"./recharts-01e4e4c7.js";import"./@babel-b6a8f64b.js";import"./scheduler-765c72db.js";import"./@stencil-932bb4b7.js";import"./tslib-6635c9de.js";import"./history-7b45d6f2.js";import"./resolve-pathname-e210f2ac.js";import"./value-equal-17d7769a.js";import"./tiny-invariant-dd7d57d2.js";import"./ionicons-e7a230f1.js";import"./prop-types-24cf8ac8.js";import"./path-to-regexp-be68b90d.js";import"./hoist-non-react-statics-0327c882.js";import"./lodash-342afa4b.js";import"./classnames-7fb9d01f.js";import"./react-smooth-56abd209.js";import"./fast-equals-a0711cdd.js";import"./victory-vendor-3e102f07.js";import"./d3-scale-7f75a621.js";import"./internmap-7949acc8.js";import"./d3-array-7d9b19f9.js";import"./d3-time-format-aa787c71.js";import"./d3-time-9ce187c0.js";import"./d3-interpolate-cc29afb1.js";import"./d3-color-f6f4f089.js";import"./d3-format-ffdb8652.js";import"./recharts-scale-61b805bd.js";import"./decimal.js-light-6fe16ef2.js";import"./d3-shape-cb61d168.js";import"./d3-path-7123e616.js";import"./eventemitter3-e4f2284c.js";function rs(){import.meta.url,import("_").catch(()=>1);async function*n(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const Ee="/assets/logo-ea6871ca.png";const Q=class Q{constructor(){T(this,"userList");T(this,"statusList");T(this,"loggedInUser");this.statusList=["Active","In-active","Idle"],this.userList=[],this.getUsersfromDatabse()}getUsers(){return this.userList}findUser(t,s){return console.log("findUseMethod "+t+" "+s+"."),this.userList.find(o=>o.email===t&&o.password===s)}getStatuses(){return this.statusList}static getInstance(){return Q.instance||(Q.instance=new Q),Q.instance}generateRandomUserId(){return Math.floor(Math.random()*1e4)}setLogedInUser(t){this.loggedInUser=t,localStorage.setItem("username",t)}setLoggedRole(t){localStorage.setItem("role",t)}logOutUser(){this.loggedInUser=void 0,localStorage.removeItem("username")}async getUsersfromDatabse(){const s=await(await fetch("https://localhost:3000/api/user/getUser")).json();return console.log(s),this.userList=s.data,this.userList}async addUsertoDatabase(t){const o=await(await fetch("https://localhost:3000/api/user/AddUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();this.userList.push(o),this.getUsersfromDatabse()}getLoggedUser(){return localStorage.getItem("username")}getLoggedRole(){return localStorage.getItem("role")}};T(Q,"instance");let w=Q;const Z=class Z{constructor(){T(this,"shuttles");this.shuttles=[],this.getShuttlesFromDatabse()}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}getShuttles(t=""){return new Promise((s,o)=>{const a=setInterval(()=>{if(this.shuttles.length>0){clearInterval(a);const c=this.shuttles.filter(r=>t.trim()===""||r.shuttleName&&r.shuttleName.includes(t));s(c)}},1e3)})}addShuttle(t){this.shuttles.push(t)}generateRandomShuttleID(){return Math.floor(Math.random()*1e4)}getShuttleByID(t){return this.shuttles.find(s=>s.shuttleID===t)}getShuttleByDriverID(t){return this.shuttles.find(s=>s.driverID===t)}getSeatsByShuttleID(t){let s=this.shuttles.find(o=>o.shuttleID===t);return s?s.numberOfseats:void 0}removeShuttle(t){this.shuttles=this.shuttles.filter(s=>s.shuttleID!==t)}getShuttlesByIDs(t){return new Promise((s,o)=>{const a=setInterval(()=>{if(this.shuttles.length>0){clearInterval(a);let c=[];t.forEach(r=>{let l=this.shuttles.find(d=>d.shuttleID===r);l&&c.push(l)}),s(c)}},1e3)})}setSelectedShuttle(t){localStorage.setItem("shuttleId",t.toString())}getSelectedShuttle(){const t=localStorage.getItem("shuttleId");return console.log("Selected"+t),t?parseInt(t):0}async getShuttlesFromDatabse(){fetch("https://localhost:3000/api/shuttle/getShuttle").then(t=>t.json()).then(t=>{this.shuttles=t.data,console.log(t)}).catch(t=>{console.error("Error:",t)})}addShuttlesToDataBase(t){fetch("https://localhost:3000/api/shuttle/AddShuttle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error("Error:",s)),this.getShuttlesFromDatabse()}};T(Z,"instance");let M=Z;const Ke=()=>{const[n,t]=i.useState(),[s,o]=i.useState(),a=w.getInstance(),c=M.getInstance(),r=h=>{t(h.detail.value)},l=h=>{o(h.detail.value)},d=J(),u=h=>{if(n===null)console.log("Invalid username or password");else{console.log(n+" "+s);var m=a.findUser(n,s);if(console.log(m),m)if(a.setLogedInUser(m.email),console.log(m),(m==null?void 0:m.role)=="driver"){const x=c.getShuttleByDriverID(n);c.setSelectedShuttle(x==null?void 0:x.shuttleID),a.setLoggedRole("driver"),console.log(x==null?void 0:x.shuttleID),d.push("/DriverHomePage")}else(m==null?void 0:m.role)=="user"?(a.setLoggedRole("user"),d.push("/StudentHome")):(m==null?void 0:m.role)=="admin"&&(a.setLoggedRole("admin"),d.push("/AdminHomePage"))}};return e.jsxs("div",{children:[e.jsx("h4",{className:"ion-text-center ion-margin-top",children:"VC Shuttle"}),e.jsx("form",{onSubmit:u,children:e.jsx(De,{children:e.jsx(ve,{className:"ion-justify-content-center ion-align-items-center",style:{height:"10%"},children:e.jsxs(Le,{size:"12",sizeMd:"6",sizeLg:"4",sizeXl:"3",children:[e.jsx("div",{className:"ion-text-center ion-padding",children:e.jsx("img",{src:Ee,alt:"Place holder logo",width:"50%"})}),e.jsx(N,{className:"ion-margin-top",label:"Email","label-placement":"floating",type:"email",fill:"outline",placeholder:"Enter email",value:n,onIonChange:r}),e.jsx(N,{className:"ion-margin-top",label:"Password","label-placement":"floating",type:"password",fill:"outline",placeholder:"Enter Password",value:s,onIonChange:l}),e.jsx(I,{className:"ion-margin-top",type:"submit",expand:"block",children:"Log In"}),e.jsx(I,{className:"ion-margin-top",routerLink:"/StudentRegister",expand:"block",children:"Sign Up"})]})})})})]})},Ve=()=>e.jsxs(A,{children:[e.jsx(f,{}),e.jsx(b,{children:e.jsx(Ke,{})})]}),He="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtklEQVR4nO2RPQ6CQBBGX4GV2utVjF6Du4itXsRCb6PcwVISChutlmwyJoYs+8d08pIpCN83LwwwkUEBlMAZqIEGaAHTm1be1ZItpetlDdwdy0zk3ICVT3AdsdzIXHyCRkHw9Am+oQ3pbH/6QUEuZhKoncj+sFR2KYKx8weCPTAHqohlrmxQsJDnZYTAlR3kIYFKiocIQT9rdwxyUrj/0SeYKQgKAnwk+A4Fczv2TK/Qpyp0dOgAM4XfTq0lFMYAAAAASUVORK5CYII=",q=class q{constructor(){T(this,"locations");this.locations=[],this.getLocationsFromDB()}static getInstance(){return q.instance||(q.instance=new q),q.instance}getLocations(){return new Promise((t,s)=>{const o=setInterval(()=>{this.locations.length>0&&(clearInterval(o),t(this.locations))},1e3)})}generateRandomLocationID(){return Math.floor(Math.random()*1e3)}getLocationByID(t){var s;return console.log("Given"+((s=this.locations.find(o=>o.locationId===t))==null?void 0:s.locationName)),this.locations.find(o=>o.locationId==t)}getexcludedLocations(t){var s=this.locations.filter(o=>o.locationName===t);return s}async getLocationsFromDB(){fetch("https://localhost:3000/api/locations/getLocation").then(t=>t.json()).then(t=>{this.locations=t.data,console.log(t)}).catch(t=>{console.error("Error:",t)})}async addLocation(t){const s=await fetch("https://localhost:3000/api/locations/AddLocation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("HTTP error! status: ".concat(s.status));const o=await s.json();return new Promise((a,c)=>{o.Message==="Location Added"?(this.locations.push(t),a()):c("Location added successfully")})}};T(q,"instance");let H=q;const K=class K{constructor(){T(this,"mapRoutes",[]);this.fetchDriverRoutes()}static getInstance(){return K.instance||(K.instance=new K),K.instance}fetchDriverRoutes(){fetch("https://localhost:3000/api/driveRoute/getDriveRoute").then(t=>t.json()).then(t=>{this.mapRoutes=t.data.map(s=>({driverRouteID:s.driverRouteID,scheduleID:s.scheduleID,driverName:s.driverName,shuttleID:s.shuttleID,startLocationID:s.startLocationID,endLocationID:s.endLocationID,departureTime:new Date(s.departureTime?s.departureTime:1)})),console.log("Map",this.mapRoutes)}).catch(t=>console.error("Error:",t))}addDriverRoutesToDatabase(t){fetch("https://localhost:3000/api/driveRoute/AddDriveRoute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error("Error:",s))}generateRoutes(t,s,o,a,c,r,l){console.log();const d=[];let u=t+s,h=new Date,m=h.getFullYear(),x=h.getMonth(),j=h.getDate(),k=new Date(l.startTime),D=new Date(l.endTime),R=k.getHours(),F=k.getMinutes(),O=k.getSeconds(),ne=D.getHours(),le=D.getMinutes(),fe=D.getSeconds();k=new Date(m,x,j,R,F,O),D=new Date(m,x,j,ne,le,fe),h.getTime()>k.getTime()&&(k.setDate(k.getDate()+1),D.setDate(D.getDate()+1));let me=Math.floor((D.getTime()-k.getTime())/(u*1e3)),re=new Date,de="".concat(re.getFullYear()).concat(("0"+(re.getMonth()+1)).slice(-2)).concat(("0"+re.getDate()).slice(-2));for(let oe=0;oe<me;oe++){let Pe=oe%2===0?o:a,Fe=oe%2===0?a:o,ue={driverRouteID:"tr".concat(l.scheduleID,"-").concat(c,"-").concat(oe,"-").concat(de),scheduleID:l.scheduleID,driverName:r,seatsBooked:0,shuttleID:c,departureTime:new Date(k.getTime()+oe*u*1e3),startLocationID:Pe.locationId,endLocationID:Fe.locationId};console.log("preRoute"+ue),this.addDriverRoutesToDatabase(ue),d.push(ue),this.mapRoutes.push(ue)}return this.fetchDriverRoutes(),console.log(this.mapRoutes),d}getRoutesByStartAndEndLocation(t,s){let o=new Date;return o.setHours(0,0,0,0),console.log(this.mapRoutes),this.mapRoutes.filter(a=>a.startLocationID===t&&a.endLocationID===s&&new Date(a.departureTime)>=o)}getByShuttleID(t){console.log(t);for(let s of this.mapRoutes)if(s.shuttleID===t)return s;return null}getRoutesForSession(t,s,o){let a=new Date;a.setHours(0,0,0,0);const c=this.mapRoutes.filter(r=>r.scheduleID===t&&r.startLocationID===s&&r.endLocationID===o&&new Date(r.departureTime)>=a);return console.log("Available routes"+c.length),c}getRoutesByShuttleID(t){return new Promise((s,o)=>{const a=setInterval(()=>{if(this.mapRoutes.length>0){clearInterval(a);let c=new Date;c.setHours(0,0,0,0),s(this.mapRoutes.filter(r=>r.shuttleID===t&&new Date(r.departureTime)>=c))}},1e3)})}getByDriverRouteID(t){const s=new Date;return this.mapRoutes.find(o=>o.driverRouteID===t&&o.departureTime>s)}};T(K,"instance");let U=K;const V=class V{constructor(){T(this,"bookings");this.fetchBookings(),this.bookings=[]}static getInstance(){return V.instance||(V.instance=new V),V.instance}getBookings(t){return new Promise((s,o)=>{const a=setInterval(()=>{this.bookings.length>0&&(clearInterval(a),s(this.bookings.filter(c=>c.userId==t)))},1e3)})}getAllRecentBookingsByShuttleID(t,s=""){return new Promise((o,a)=>{const c=setInterval(()=>{if(this.bookings.length>0){clearInterval(c);const r=new Date;r.setHours(0,0,0,0);const l=this.bookings.filter(d=>d.shuttleID===t&&new Date(d.bookingTime)>=r&&(s.trim()===""||d.userId&&d.userId.includes(s)));o(l)}},1e3)})}getAllBookings(t=""){return new Promise((s,o)=>{const a=setInterval(()=>{if(this.bookings.length>0){clearInterval(a);const c=this.bookings.filter(r=>t.trim()===""||r.userId&&r.userId.includes(t));s(c)}},1e3)})}countBookingsByDate(t){return new Promise((s,o)=>{setTimeout(()=>{const a=new Map;for(const c of t){const l=new Date(c.bookingTime).toISOString().split("T")[0];if(a.has(l)){const d=a.get(l);d!==void 0&&a.set(l,d+1)}else a.set(l,1)}s(a)},1e3)})}getActiveBookings(t){return new Promise((s,o)=>{const a=setInterval(()=>{this.bookings.length>0&&(clearInterval(a),s(this.bookings.filter(c=>{let r=new Date,l=new Date(c.bookingTime);return l.getFullYear()===r.getFullYear()&&l.getMonth()===r.getMonth()&&l.getDate()===r.getDate()&&c.userId==t})))},1e3)})}addBooking(t){this.bookings.push(t),console.log(t)}getBookingById(t){return this.bookings.find(s=>s.bookingid===t)}removeBooking(t){this.bookings=this.bookings.filter(s=>s.bookingid!==t)}getNumberOfBookingsForTrip(t){return console.log("trip id = "+t),console.log("number of bookings"+this.bookings.length),this.bookings.filter(s=>s.tripId===t).length}generateBookingID(){length=10;const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="bk";for(let o=0;o<length;o++)s+=t.charAt(Math.floor(Math.random()*t.length));return s}getBookingsByUserId(t){return this.bookings.filter(s=>s.userId===t)}getBookingsByTripId(t){return this.bookings.filter(s=>s.tripId===t)}getBookingsByUserID(t){return this.bookings.filter(o=>o.userId.includes(t)||o.bookingid.includes(t))}getActiveBookingsCount(t){let s=0,o=new Date;for(let a of this.bookings)a.shuttleID===t&&a.bookingTime>o&&s++;return s}addBookingsForUser(t){fetch("https://localhost:3000/api/bookings/AddBooking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error("Error:",s))}fetchBookings(){fetch("https://localhost:3000/api/bookings/getBookings").then(t=>t.json()).then(t=>{this.bookings=t.data,console.log(t)}).catch(t=>{console.error("Error:",t)})}getBookingsForToday(t){const s=new Date;s.setHours(0,0,0,0);const o=new Date(s);return o.setDate(o.getDate()+1),this.bookings.filter(a=>{const c=new Date(a.bookingTime);return a.userId===t&&c>=s&&c<o})}countBookingsBySession(t){const s=new Map;for(const o of t){const a=o.session;if(s.has(a)){const c=s.get(a);c!==void 0&&s.set(a,c+1)}else s.set(a,1)}return s}};T(V,"instance");let E=V;const X=class X{constructor(){T(this,"schedules");this.schedules=[],this.getSchedulesFromDatabase()}static getInstance(){return X.instance||(X.instance=new X),X.instance}getSchedules(t=""){return new Promise((s,o)=>{const a=setInterval(()=>{if(this.schedules.length>0){clearInterval(a);const c=this.schedules.filter(r=>t.trim()===""||r.scheduleName&&r.scheduleName.includes(t));s(c)}},1e3)})}getScheduleByID(t){return this.schedules.find(s=>s.scheduleID==t)}async getSchedulesFromDatabase(){fetch("https://localhost:3000/api/schedule/getSchedule").then(t=>t.json()).then(t=>{this.schedules=t.data,console.log(t)}).catch(t=>{console.error("Error:",t)})}async addSchedulesToDataBAse(t){fetch("https://localhost:3000/api/schedule/AddSchedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error("Error:",s)),this.getSchedulesFromDatabase()}};T(X,"instance");let z=X;$.accessToken="pk.eyJ1IjoidGhlcmVhbGJvbmdhIiwiYSI6ImNsbG0yMXF2dTJqZm0zZ21nbm43b3RyamYifQ.DeWMvQ5HgM53BMjgWqc2TQ";const _=class _{constructor(){}static getInstance(){return _.instance||(_.instance=new _),_.instance}formatDuration(t){const s=Math.floor(t/3600),o=Math.floor(t%3600/60),a=Math.floor(t%60);return"".concat(s," hours, ").concat(o," minutes, and ").concat(a," seconds")}setTravelEndLocation(t){localStorage.setItem("travelStop_EndLocation_Latitude",t.latitude.toString()),localStorage.setItem("travelStop_EndLocation_Longitude",t.longitude.toString()),localStorage.setItem("travelStop_EndLocation_LocName",t.locationName)}setStartEndLocation(t,s){localStorage.setItem("shuttleStop_StartLocation_Latitude",t.latitude.toString()),localStorage.setItem("shuttleStop_StartLocation_Longitude",t.longitude.toString()),localStorage.setItem("shuttleStop_StartLocation_LocName",t.locationName),localStorage.setItem("shuttleStop_EndLocation_Latitude",s.latitude.toString()),localStorage.setItem("shuttleStop_EndLocation_Longitude",s.longitude.toString()),localStorage.setItem("shuttleStop_EndLocation_LocName",s.locationName)}getStartLocation(){const t=parseFloat(localStorage.getItem("shuttleStop_StartLocation_Latitude")||"0"),s=parseFloat(localStorage.getItem("shuttleStop_StartLocation_Longitude")||"0"),o=localStorage.getItem("shuttleStop_StartLocation_LocName")||"";return{latitude:t,longitude:s,locationName:o}}getTravelEndLocation(){const t=parseFloat(localStorage.getItem("travelStop_EndLocation_Latitude")||"0"),s=parseFloat(localStorage.getItem("travelStop_EndLocation_Longitude")||"0"),o=localStorage.getItem("travelStop_EndLocation_LocName")||"";return{latitude:t,longitude:s,locationName:o}}getEndLocation(){const t=parseFloat(localStorage.getItem("shuttleStop_EndLocation_Latitude")||"0"),s=parseFloat(localStorage.getItem("shuttleStop_EndLocation_Longitude")||"0"),o=localStorage.getItem("shuttleStop_EndLocation_LocName")||"";return{latitude:t,longitude:s,locationName:o}}async getTimeToGetToDestanation(t,s){const o="https://api.mapbox.com/directions/v5/mapbox/driving-traffic/".concat(t.longitude,",").concat(t.latitude,";").concat(s.longitude,",").concat(s.latitude,"?access_token=").concat($.accessToken,"&geometries=geojson");try{const c=(await qe.get(o)).data.routes;return c.length>0?c[0].duration:(console.log("No routes found"),0)}catch(a){return console.error("Error fetching directions:",a),0}}async getETATravelTimes(t,s){const o=new Map,a=t.find(c=>c.locationName===s);if(!a)return console.error("Start location not found"),o;for(const c of t){if(a.locationId===c.locationId)continue;const r=await this.getTimeToGetToDestanation(a,c),l="".concat(a.locationId,"-").concat(c.locationId);o.set(l,r)}return o}};T(_,"instance");let Y=_;const Xe=({trip:n})=>{const[t,s]=i.useState(),[o,a]=i.useState(),[c,r]=i.useState(),[l,d]=i.useState(),[u,h]=i.useState(),m=M.getInstance(),x=E.getInstance();U.getInstance();const j=H.getInstance(),k=z.getInstance(),D=Y.getInstance(),R=J(),F=()=>{t&&o&&D.setStartEndLocation(t,o),R.push("/StudentMap")};return i.useEffect(()=>{console.log("Trip"+n),n&&(s(j.getLocationByID(n?n.startLocationID:1)),a(j.getLocationByID(n?n.endLocationID:1)),r(m.getSeatsByShuttleID(n?n.shuttleID:1)),d(x.getNumberOfBookingsForTrip(n?n.driverRouteID:"")),h(k.getScheduleByID(n?n.scheduleID:1)))},[n]),e.jsx("div",{children:e.jsxs(ke,{children:[e.jsx(f,{title:"Title",children:e.jsxs(be,{className:"ion-padding flex-container",children:[e.jsx("div",{children:e.jsx("img",{src:He,alt:"BusIcon"})}),n?l:"N/A"," /"," ",n?c:"N/A"," Seats"]})}),e.jsxs(he,{className:"ion-padding",children:[" ",n?t==null?void 0:t.locationName:"N/A"," -"," ",n?o==null?void 0:o.locationName:"N/A"]}),e.jsx(we,{children:"https://ionicframework.com/docs/api/progress-bar"}),e.jsxs(he,{className:"ion-padding",children:["Departure time:"," ",n?new Date(n.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"]}),e.jsxs(he,{className:"ion-padding",children:["Shuttle : ",n?n.shuttleID:"N/A"]}),e.jsx(I,{onClick:F,className:"ion-padding",children:"Track"})]})})},_e=()=>{const[n,t]=i.useState([]),s=E.getInstance(),o=w.getInstance();E.getInstance();const a=H.getInstance();return U.getInstance(),i.useEffect(()=>{s.fetchBookings(),(async()=>{const r=await s.getActiveBookings(o.getLoggedUser());t(r)})()},[]),e.jsx("div",{className:"ion-padding",children:e.jsx(C,{children:n.map(c=>{var r,l;return e.jsx(S,{children:e.jsxs(g,{children:[(r=a.getLocationByID(c.startLocation))==null?void 0:r.locationName,"- ",(l=a.getLocationByID(c.endLocation))==null?void 0:l.locationName]})},c.bookingid)})})})},et="/assets/listicon-0208f592.png",tt="/assets/clockicon-c95bbea6.png",st="/assets/mapblackpin-0e67bc73.png",nt="/assets/star-98fa98b8.png",ce=()=>e.jsx("div",{children:e.jsxs(xe,{contentId:"main-studentcontent",children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(v,{children:"Menu"})})}),e.jsx(b,{children:e.jsxs(C,{children:[e.jsx(S,{routerLink:"/StudentHome",children:"Home"}),e.jsx(S,{routerLink:"/StudentBookingList",children:"Bookings"}),e.jsx(S,{routerLink:"/LocationsList",children:"Locations"}),e.jsx(S,{routerLink:"/",children:"Logout"})]})})]})}),W=({onLocationSelect:n})=>{const[t,s]=i.useState([]),o=H.getInstance();return i.useEffect(()=>{(async()=>{const c=await o.getLocations();s(c)})()},[]),e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Locations",placeholder:"Select a Location",onIonChange:a=>n(a.detail.value),children:t.map(a=>e.jsx(ie,{value:a.locationId,children:a.locationName},a.locationId))})})})})},je=({startLocation:n,endLocation:t,onDriverRouteSelect:s})=>{const[o,a]=i.useState([]),c=U.getInstance();i.useEffect(()=>{a(c.getRoutesByStartAndEndLocation(n,t))},[n,t]);const r=l=>{const d=l.detail.value;s(d)};return e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Driver Route",placeholder:"Driver Route",onIonChange:r,children:o.map(l=>e.jsx(ie,{value:l.driverRouteID,children:"Departure Time: ".concat(new Date(l.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))},l.driverRouteID))})})})})};const ot=({onShuttleSelect:n})=>{const[t,s]=i.useState([]),o=new M;return i.useEffect(()=>{(async()=>{const c=await o.getShuttles();s(c)})()},[]),e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Shuttles",placeholder:"Select a Shuttle",onIonChange:a=>n(a.detail.value),children:t.map(a=>e.jsx(ie,{value:a.shuttleID,children:a.shuttleName},a.shuttleID))})})})})},ee=class ee{constructor(){T(this,"reviews",[]);T(this,"isFetching",!1)}static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}async fetchReviewsFromBackend(){try{const t=await fetch("https://localhost:3000/api/reviewsRoute/getReviews"),s=await t.json();if(!t.ok)throw new Error("HTTP error! Status: ".concat(t.status));this.reviews=s}catch(t){throw console.error("Error fetching reviews from backend:",t),t}finally{this.isFetching=!1}}async addReviewsToDatabse(t){fetch("https://localhost:3000/api/reviewsRoute/addReviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.error("Error:",s)),this.fetchReviewsFromBackend()}generateReviewID(){return Math.floor(Math.random()*1e6)}async getReviews(){return this.isFetching&&await new Promise(t=>setTimeout(t,100)),this.reviews.length===0&&(this.isFetching=!0,await this.fetchReviewsFromBackend()),this.reviews}async getReviewByID(t){return(await this.getReviews()).find(o=>o.reviewId===t)}async getReviewByUsername(t){return(await this.getReviews()).filter(o=>o.username.toLowerCase().includes(t.toLowerCase()))}};T(ee,"instance");let ge=ee;const at=()=>{const n=i.useRef(null),t=i.useRef(null),[s,o]=i.useState(0),[a,c]=i.useState(),[r,l]=i.useState(),d=ge.getInstance(),u=w.getInstance(),h=j=>{o(j),console.log("User selected ".concat(j," stars"))};function m(){var j,k;if(a&&r){const D={description:a,reviewId:d.generateReviewID(),shuttle:r,stars:s,username:u.getLoggedUser()};d.addReviewsToDatabse(D)}(k=n.current)==null||k.dismiss((j=t.current)==null?void 0:j.value,"confirm")}function x(j){j.detail.role}return e.jsx("div",{children:e.jsxs(te,{ref:n,trigger:"open-ReviewsModal",onWillDismiss:j=>x(j),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var j;return(j=n.current)==null?void 0:j.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Reviews"}),e.jsx(L,{slot:"end",children:e.jsx(I,{strong:!0,onClick:()=>m(),children:"Confirm"})})]})}),e.jsx("div",{className:"stars",children:[5,4,3,2,1].map(j=>e.jsxs(e.Fragment,{children:[e.jsx("input",{className:"star star-".concat(j),id:"star-".concat(j),type:"radio",name:"star",onClick:()=>h(j)}),e.jsx("label",{className:"star star-".concat(j),htmlFor:"star-".concat(j)})]}))}),e.jsxs("div",{className:"ion-padding",children:[e.jsx(ot,{onShuttleSelect:l}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Description"}),e.jsx(N,{label:"",value:a,onIonChange:j=>c(j.detail.value)})]})]})]})})},it=()=>{i.useState(null);const[n,t]=i.useState(null),[s,o]=i.useState(null),[a,c]=i.useState(null),[r,l]=i.useState(null),d=U.getInstance(),u=E.getInstance();return M.getInstance(),z.getInstance(),i.useEffect(()=>{if(u.fetchBookings(),r){console.log("Selected Route id "+r);const h=d.getByDriverRouteID(r);t(h),console.log("Selected Route"+(h==null?void 0:h.departureTime))}},[r]),e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-studentcontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Home"})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs("section",{children:[e.jsx(g,{className:"ion-padding textio",children:"Start location"}),e.jsxs("section",{className:"sectionio ion-padding",children:[e.jsx(W,{onLocationSelect:o}),e.jsx(I,{routerLink:"/ShuttleBooking",className:"ion-padding",children:"Book"})]}),e.jsx(g,{className:"ion-padding textiog",children:"End location"}),e.jsx("div",{className:"ion-padding",children:e.jsx(W,{onLocationSelect:c})}),e.jsx("div",{className:"ion-padding",children:e.jsx(je,{onDriverRouteSelect:l,startLocation:s||0,endLocation:a||0})})]}),e.jsx(Xe,{trip:n||void 0}),e.jsxs("div",{className:"button-container",children:[e.jsx(I,{routerLink:"/StudentBookingList",children:e.jsx("div",{children:e.jsx("img",{src:et,height:"48px",alt:"Bookings"})})}),e.jsx(I,{routerLink:"/LocationsList",children:e.jsx("div",{children:e.jsx("img",{src:st,height:"48px",alt:"Locations"})})}),e.jsx(I,{routerLink:"/StudentScheduledTrips",children:e.jsx("div",{children:e.jsx("img",{src:tt,height:"48px",alt:"Schedules"})})}),e.jsx(I,{id:"open-ReviewsModal",children:e.jsx("div",{children:e.jsx("img",{src:nt,height:"48px",alt:"Schedules"})})}),e.jsx(at,{})]}),e.jsx("br",{}),e.jsx(g,{className:"ion-padding",children:"Todays Bookings"}),e.jsx(_e,{})]})]}),e.jsx(ce,{})]})},Se=({onScheduleSelect:n})=>{const[t,s]=i.useState([]),o=new z;return i.useEffect(()=>{(async()=>{const c=await o.getSchedules();s(c)})()},[]),e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Schedules",placeholder:"Select a Time slot",onIonChange:a=>n(a.detail.value),children:t.map(a=>e.jsx(ie,{value:a.scheduleID,children:a.scheduleName},a.scheduleID))})})})})},Ue=({sessionId:n,startLocation:t,endLocation:s,onShuttleSelect:o})=>{const[a,c]=i.useState([]);i.useState([]);const r=M.getInstance(),l=U.getInstance();return i.useEffect(()=>{const d=l.getRoutesForSession(n,t,s);console.log("Found"+d.length);const u=new Set;d.forEach(m=>{u.has(m.shuttleID)||u.add(m.shuttleID)}),console.log("Available shuttleID",Array.from(u)),console.log("Parsed settings session: "+n+" start :"+t+" end: "+s),(async()=>{const m=await r.getShuttlesByIDs(u);c(m)})()},[n,t,s]),e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Shuttles",placeholder:"Select a Shuttle",onIonChange:d=>o(d.detail.value),children:a.map(d=>e.jsx(ie,{value:d.shuttleID,children:d.shuttleName},d.shuttleID))})})})})},rt=()=>{const n=E.getInstance(),t=w.getInstance(),[s,o]=i.useState(null),[a,c]=i.useState(null),[r,l]=i.useState(null),[d,u]=i.useState(null),[h,m]=i.useState(null),x=J(),j=k=>{if(s===null||a===null||r===null||d===null||h===null)console.error("Please select all values.");else{k.preventDefault();const D={bookingid:n.generateBookingID(),userId:t.getLoggedUser(),session:a,shuttleID:s,bookingStatus:"Active",startLocation:r,endLocation:d,bookingTime:new Date,tripId:h};n.addBookingsForUser(D),x.push("/StudentHome")}};return e.jsxs("form",{onSubmit:j,children:[e.jsxs(A,{id:"main-studentcontent",children:[e.jsxs(f,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(p,{children:e.jsx(v,{children:"Shuttle Booking"})})]}),e.jsxs(b,{className:"ion-padding",children:[e.jsx(Se,{onScheduleSelect:c}),e.jsx(g,{children:"Start location"}),".",e.jsx(W,{onLocationSelect:l}),e.jsx(g,{children:"End location"}),e.jsx(W,{onLocationSelect:u}),e.jsx(je,{onDriverRouteSelect:m,startLocation:r||0,endLocation:d||0}),e.jsx(Ue,{onShuttleSelect:o,sessionId:a||0,startLocation:r||0,endLocation:d||0}),e.jsx(I,{className:"ion-margin-top",type:"submit",children:"Submit"})]})]}),e.jsx(ce,{})]})},ct=()=>{const[n,t]=i.useState([]),[s,o]=i.useState([]);i.useState([]);const a=E.getInstance();U.getInstance();const c=H.getInstance(),r=w.getInstance();return i.useEffect(()=>{(async()=>{t(await a.getBookings(r.getLoggedUser()))})(),o(a.getBookingsByUserId(r.getLoggedUser()))},[]),e.jsxs("div",{children:[e.jsx(Ge,{className:"ion-padding",children:"All Bookings"}),e.jsx(C,{inset:!0,children:n.map(l=>{var d,u;return e.jsxs(S,{children:[e.jsx(g,{children:new Date(l.bookingTime).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),e.jsxs(g,{children:[(d=c.getLocationByID(l.startLocation))==null?void 0:d.locationName,"to"," ",(u=c.getLocationByID(l.endLocation))==null?void 0:u.locationName]})]},l.bookingid)})})]})},lt=()=>e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-studentcontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Booking list"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(ct,{})})]}),e.jsx(ce,{})]}),dt=({trip:n})=>{const[t,s]=i.useState(),[o,a]=i.useState(),[c,r]=i.useState(),[l,d]=i.useState(),[u,h]=i.useState(),m=M.getInstance(),x=E.getInstance();U.getInstance();const j=H.getInstance(),k=z.getInstance();i.useEffect(()=>{n&&(s(j.getLocationByID(n.startLocationID)),a(j.getLocationByID(n.endLocationID)),d(x.getNumberOfBookingsForTrip(n.driverRouteID)),r(m.getSeatsByShuttleID(n.shuttleID)),h(k.getScheduleByID(n.scheduleID)))},[n]);const D=Y.getInstance(),R=J(),F=()=>{t&&o&&D.setStartEndLocation(t,o),R.push("/StudentMap")};return e.jsx("div",{children:e.jsxs(ke,{children:[e.jsx(f,{title:"Title",children:e.jsxs(be,{className:"ion-padding",children:[e.jsx("div",{children:e.jsx("img",{src:He,alt:"BusIcon"})}),n?l:"N/A"," / ",n?c:"N/A"," Seats"]})}),e.jsxs(he,{className:"ion-padding",children:[" ",n?t==null?void 0:t.locationName:"N/A"," - ",n?o==null?void 0:o.locationName:"N/A"]}),e.jsx(we,{children:"https://ionicframework.com/docs/api/progress-bar"}),e.jsxs(We,{children:["Departure time: ",n?new Date(n.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"]}),e.jsx(I,{onClick:F,className:"ion-padding",children:"Track"})]})})},pe=()=>{const n=w.getInstance(),t=()=>{n.logOutUser(),localStorage.clear()};return e.jsx("div",{children:e.jsxs(xe,{contentId:"main-Drivercontent",children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(v,{children:"Menu"})})}),e.jsx(b,{children:e.jsxs(C,{children:[e.jsx(S,{routerLink:"/DriverHomePage",children:"Home"}),e.jsx(S,{routerLink:"/DriverCreateRoute",children:"Trips"}),e.jsx(S,{routerLink:"/DriverBookingPage",children:"Bookings"}),e.jsx(S,{routerLink:"/",onClick:t,children:"Logout"})," "]})})]})})},ut=({shuttleId:n,onDriverRouteSelect:t})=>{const s=U.getInstance();w.getInstance();const[o,a]=i.useState([]);i.useEffect(()=>{console.log("Myshuttle"+n),(async()=>{const l=await s.getRoutesByShuttleID(n);a(l)})()},[]);const c=r=>{const l=r.detail.value;t(l)};return e.jsx("div",{children:e.jsx(C,{children:e.jsx(S,{className:"ion-padding",children:e.jsx(ae,{"aria-label":"Driver Route",placeholder:"Driver Route",onIonChange:c,children:o.map(r=>e.jsx(ie,{value:r.driverRouteID,children:"Departure Time: ".concat(new Date(r.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))},r.driverRouteID))})})})})},ht=()=>{var k;if(w.getInstance().getLoggedRole()!=="driver")return e.jsx(P,{to:"/"});i.useState();const[t,s]=i.useState(null),[o,a]=i.useState(null),[c,r]=i.useState(),l=U.getInstance(),d=M.getInstance(),u=w.getInstance();E.getInstance(),(k=d.getShuttleByDriverID(u.getLoggedUser()))==null||k.shuttleID;const[h,m]=i.useState(!0),[x,j]=i.useState(u.getLoggedUser());return i.useEffect(()=>{(async()=>{await l.fetchDriverRoutes(),m(!1)})()},[x]),i.useEffect(()=>{j(u.getLoggedUser())},[]),i.useEffect(()=>{var R,F,O;console.log("useEffect 1 is running"),console.log("Logged user"+u.getLoggedUser()),console.log("Driver Shuttle "+((R=d.getShuttleByDriverID(u.getLoggedUser()))==null?void 0:R.shuttleID));const D=(F=d.getShuttleByDriverID(u.getLoggedUser()))==null?void 0:F.shuttleID;r((O=d.getShuttleByDriverID(u.getLoggedUser()))==null?void 0:O.shuttleID),console.log("selected shuttle = "+D),l.fetchDriverRoutes()},[x]),i.useEffect(()=>{if(console.log("useEffect 2 is running"),o){const D=l.getByDriverRouteID(o);s(D),console.log("Selected Route"+t)}},[o,x]),h?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-Drivercontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Driver"})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsx(ut,{shuttleId:d.getSelectedShuttle(),onDriverRouteSelect:a}),e.jsx(I,{routerLink:"/DriverCreateRoute",className:"ion-padding",children:"ROUTE"}),e.jsx(dt,{trip:t||void 0})]})]}),e.jsx(pe,{})]})};$.accessToken="pk.eyJ1IjoidGhlcmVhbGJvbmdhIiwiYSI6ImNsbG0yMXF2dTJqZm0zZ21nbm43b3RyamYifQ.DeWMvQ5HgM53BMjgWqc2TQ";const gt=({startLocation:n,endLocation:t})=>{const s=i.useRef(null);i.useRef(null);const[o,a]=i.useState(-70.9),[c,r]=i.useState(42.35),[l,d]=i.useState(9);return i.useRef(new $.Popup({offset:15})),i.useEffect(()=>{if(s.current){const u=new $.Map({container:s.current,style:"mapbox://styles/mapbox/streets-v11",center:[n.longitude,n.latitude],zoom:15});return console.log("Locations"+n.longitude),u.on("load",function(){u.loadImage("https://docs.mapbox.com/mapbox-gl-js/assets/custom_marker.png",function(h,m){if(h)throw h;if(m){u.addImage("custom-marker",m),u.resize();const x={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[n.longitude,n.latitude]},properties:{title:n.locationName}},{type:"Feature",geometry:{type:"Point",coordinates:[t.longitude,t.latitude]},properties:{title:t.locationName}}]};u.addSource("points",{type:"geojson",data:x}),u.addLayer({id:"points",type:"symbol",source:"points",layout:{"icon-image":"custom-marker","text-field":["get","title"],"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,1.25],"text-anchor":"top"}}),fetch("https://api.mapbox.com/directions/v5/mapbox/driving-traffic/".concat(n.longitude,",").concat(n.latitude,";").concat(t.longitude,",").concat(t.latitude,"?geometries=geojson&access_token=").concat($.accessToken)).then(j=>j.json()).then(j=>{u.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:j.routes[0].geometry}}),u.addLayer({id:"route",type:"line",source:"route",paint:{"line-width":2,"line-color":"#007cbf"}})})}else console.error("Failed to load image")})}),u.addControl(new $.NavigationControl,"top-right"),()=>u.remove()}else console.error("Failed to initialize map: mapContainer.current is null")},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"sidebar",children:["Longitude: ",o," | Latitude: ",c," | Zoom: ",l]}),e.jsx("div",{ref:s,className:"map-container"})]})},mt=()=>{const n=Y.getInstance();return e.jsxs(A,{children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(v,{children:"Locations"})})}),e.jsx(b,{className:"ion-padding",children:e.jsx(gt,{startLocation:{locationId:0,latitude:n.getStartLocation().latitude,longitude:n.getStartLocation().longitude,description:"",locationName:n.getStartLocation().locationName},endLocation:{locationId:0,latitude:n.getEndLocation().latitude,longitude:n.getEndLocation().longitude,description:"",locationName:n.getEndLocation().locationName}})})]})},xt=()=>{const{width:n,height:t,ref:s}=ye(),o=E.getInstance(),[a,c]=i.useState([]);return i.useEffect(()=>{(async()=>{const l=await o.getAllBookings();console.log(l);const d=await o.countBookingsByDate(l);console.log(d);const u=Array.from(d,([h,m])=>({name:h,uv:m}));c(u)})()},[]),e.jsx("div",{ref:s,style:{width:"100%",height:"100%"},children:n&&t&&e.jsxs(Ne,{width:n,height:t,data:a,margin:{top:5,right:20,bottom:5,left:0},children:[e.jsx(Ae,{type:"monotone",dataKey:"uv",stroke:"#8884d8"}),e.jsx(Re,{stroke:"#ccc",strokeDasharray:"5 5"}),e.jsx(Be,{dataKey:"name"}),e.jsx(Te,{}),e.jsx(Ce,{})]})})},G=()=>e.jsx("div",{children:e.jsxs(xe,{contentId:"main-content",children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(v,{children:"Menu"})})}),e.jsx(b,{children:e.jsxs(C,{children:[e.jsx(S,{routerLink:"/AdminHomePage",children:"Home"}),e.jsx(S,{routerLink:"/AdminBooking",children:"Bookings"}),e.jsx(S,{routerLink:"/AdminShuttle",children:"Shuttles"}),e.jsx(S,{routerLink:"/AdminLocations",children:"Locations"}),e.jsx(S,{routerLink:"/AdminSchedules",children:"Schedules"}),e.jsx(S,{routerLink:"/AdminUsers",children:"Users"}),e.jsx(S,{routerLink:"/Reviews",children:"Reviews"}),e.jsx(S,{routerLink:"/",children:"Logout"})]})})]})}),jt=()=>{const{width:n,height:t,ref:s}=ye(),o=E.getInstance(),a=z.getInstance(),[c,r]=i.useState([]);return i.useEffect(()=>{(async()=>{await a.getSchedules();const d=await o.getAllBookings(),u=o.countBookingsBySession(d);console.log(u);const h=Array.from(u,([m,x])=>{const j=a.getScheduleByID(m);return console.log(j),{name:j?j.scheduleName:"Unknown",uv:x}});r(h)})()},[]),e.jsx("div",{ref:s,style:{width:"100%",height:"100%"},children:n&&t&&e.jsxs(Ne,{width:n,height:t,data:c,margin:{top:5,right:20,bottom:5,left:0},children:[e.jsx(Ae,{type:"monotone",dataKey:"uv",stroke:"#8884d8"}),e.jsx(Re,{stroke:"#ccc",strokeDasharray:"5 5"}),e.jsx(Be,{dataKey:"name"}),e.jsx(Te,{}),e.jsx(Ce,{})]})})},St=()=>{if(w.getInstance().getLoggedRole()!=="admin")return e.jsx(P,{to:"/"});const[t,s]=i.useState(new Map),o=Y.getInstance(),a=H.getInstance();return i.useEffect(()=>{(async()=>{const r=await a.getLocations(),l=await o.getETATravelTimes(r,"Varsity College Sandton");s(l)})()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Admin"})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsx("p",{children:"Bookings x Date "}),e.jsx(xt,{}),e.jsx("br",{}),e.jsx("p",{children:"Estimated travel time "}),e.jsx("ul",{children:Array.from(t,([c,r])=>{var m,x;const[l,d]=c.split("-").map(Number),u=(m=a.getLocationByID(l))==null?void 0:m.locationName,h=(x=a.getLocationByID(d))==null?void 0:x.locationName;return e.jsxs("li",{children:[u,"-",h,":"," ",o.formatDuration(r)]},c)})}),e.jsx("br",{}),e.jsx("p",{children:"Peak hours "}),e.jsx(jt,{})]})]}),e.jsx(G,{})]})},pt=()=>{if(w.getInstance().getLoggedRole()!=="driver")return e.jsx(P,{to:"/"});const[t,s]=i.useState(null),[o,a]=i.useState(null),[c,r]=i.useState(null),[l,d]=i.useState(null),u=U.getInstance(),h=z.getInstance(),m=H.getInstance(),x=w.getInstance();E.getInstance();const j=Y.getInstance(),k=M.getInstance(),D=J(),R=()=>{if(t&&o&&c&&l){const F=l;console.log(x.getLoggedUser());const O=h.getScheduleByID(t);console.log("Selected session "+(O==null?void 0:O.startTime));const ne=m.getLocationByID(o),le=m.getLocationByID(c);(async()=>{var de;k.getShuttlesFromDatabse();const me=await j.getTimeToGetToDestanation(ne,le),re=(de=k.getShuttleByDriverID(x.getLoggedUser()))==null?void 0:de.shuttleID;u.generateRoutes(me,F,ne,le,re,x.getLoggedUser(),O),u.fetchDriverRoutes()})(),D.push("/DriverHomePage")}};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-Drivercontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Route"})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsx(Se,{onScheduleSelect:s}),"Start Location",e.jsx(W,{onLocationSelect:a}),"End Location",e.jsx(W,{onLocationSelect:r}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Wait time (in minutes)"}),e.jsx(N,{label:"",type:"number",value:l,onIonChange:F=>d(parseInt(F.detail.value))})]}),e.jsx(I,{className:"ion-margin-top",type:"submit",onClick:R,children:"Submit"})]})]}),e.jsx(pe,{})]})},ft=({booking:n})=>{const t=i.useRef(null),s=i.useRef(null),[o,a]=i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function c(){var l,d;(d=t.current)==null||d.dismiss((l=s.current)==null?void 0:l.value,"confirm")}function r(l){l.detail.role==="confirm"&&a("Hello, ".concat(l.detail.data,"!"))}return e.jsxs(te,{ref:t,trigger:"open-AddBookingmodal",onWillDismiss:l=>r(l),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Welcome"}),e.jsx(L,{slot:"end",children:e.jsx(I,{strong:!0,onClick:()=>c(),children:"Confirm"})})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["Booking ID: ",n?n.bookingid:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Session: ",n?n.session:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Shuttle ID: ",n?n.shuttleID:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Booking Status: ",n?n.bookingStatus:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Start Location: ",n?n.startLocation:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["End Location: ",n?n.endLocation:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Booking Time: ",n?n.bookingTime.toString():"N/A"]}),e.jsx("br",{})]})]})},It=()=>{const[n,t]=i.useState([]);i.useState([]);const s=E.getInstance();U.getInstance();const o=H.getInstance(),[a,c]=i.useState(""),[r,l]=i.useState();i.useEffect(()=>{(async()=>{n.length<=0&&s.fetchBookings();const h=await s.getAllBookings(a);t(h)})()},[a]),i.useRef(null),i.useRef(null),i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function d(u){l(s.getBookingById(u)),console.log(r)}return e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(v,{children:"Bookings"})}),e.jsx(L,{slot:"End",children:e.jsx(I,{routerLink:"AdminAddBooking",children:"ADD"})}),e.jsx(p,{children:e.jsx(se,{onIonChange:u=>c(u.detail.value?u.detail.value:"")})})]}),e.jsx(C,{id:"open-AddBookingmodal",inset:!0,children:n.map(u=>{var h,m;return e.jsxs(S,{button:!0,onClick:()=>d(u.bookingid),children:[e.jsx(g,{children:u.userId}),e.jsxs(g,{children:[(h=o.getLocationByID(u.startLocation))==null?void 0:h.locationName," ","to",(m=o.getLocationByID(u.endLocation))==null?void 0:m.locationName]})]},u.bookingid)})}),e.jsx(ft,{booking:r})]})},Dt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Admin"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(It,{})})]}),e.jsx(G,{})]}),vt=()=>{const n=E.getInstance(),[t,s]=i.useState(null),[o,a]=i.useState(null),[c,r]=i.useState(null),[l,d]=i.useState(null),[u,h]=i.useState(null),[m,x]=i.useState(null),j=J(),k=D=>{if(console.log(m,c,o,l,u),o===null||c===null||l===null||u===null||t===null)console.error("Please select all values.");else{D.preventDefault();const R={bookingid:n.generateBookingID(),userId:m,session:c,shuttleID:o,bookingStatus:"Active",startLocation:l,endLocation:u,bookingTime:new Date,tripId:t};n.addBookingsForUser(R),j.push("/")}};return e.jsx("form",{onSubmit:k,children:e.jsxs("div",{className:"ion-padding",children:[e.jsx(se,{className:"ion-padding"}),e.jsx(g,{children:"Student Numbe/email :"}),e.jsx(N,{className:"ion-padding",value:m,onIonChange:D=>x(D.detail.value||"")}),e.jsx(Se,{onScheduleSelect:r}),e.jsx(g,{children:"Start location"}),".",e.jsx(W,{onLocationSelect:d}),e.jsx(g,{children:"End location"}),e.jsx(W,{onLocationSelect:h}),e.jsx(je,{onDriverRouteSelect:s,startLocation:l||0,endLocation:u||0}),e.jsx(Ue,{onShuttleSelect:a,sessionId:c||0,startLocation:l||0,endLocation:u||0}),e.jsx(I,{expand:"full",type:"submit",children:"Save"})]})})},Lt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"add booking"})]})}),e.jsx(b,{children:e.jsx(vt,{})})]}),kt=()=>{const[n,t]=i.useState(""),[s,o]=i.useState(""),[a,c]=i.useState(0),[r,l]=i.useState(""),d=M.getInstance(),u=()=>{const m={shuttleID:d.generateRandomShuttleID(),shuttleName:n,driverID:s,numberOfseats:a,status:r};d.addShuttlesToDataBase(m)};return e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Shuttle Name"}),e.jsx(N,{label:"",value:n,onIonChange:h=>t(h.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Driver ID"}),e.jsx(N,{label:"",value:s,onIonChange:h=>o(h.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Number of Seats"}),e.jsx(N,{label:"",type:"number",value:a,onIonChange:h=>c(parseInt(h.detail.value,10))})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Status"}),e.jsx(N,{label:"",value:r,onIonChange:h=>l(h.detail.value)})]}),e.jsx(I,{expand:"full",onClick:u,children:"Submit"})]})},bt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Add Shuttle"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(kt,{})})]}),e.jsx(G,{})]}),wt=({shuttle:n})=>{const t=i.useRef(null),s=i.useRef(null),[o,a]=i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function c(){var l,d;(d=t.current)==null||d.dismiss((l=s.current)==null?void 0:l.value,"confirm")}function r(l){l.detail.role==="confirm"&&a("Hello, ".concat(l.detail.data,"!"))}return e.jsxs(te,{ref:t,trigger:"open-AddShuttleModal",onWillDismiss:l=>r(l),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Welcome"}),e.jsx(L,{slot:"end",children:e.jsx(I,{strong:!0,onClick:()=>c(),children:"Confirm"})})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["Shuttle ID: ",n?n.shuttleID:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Shuttle Name: ",n?n.shuttleName:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Driver ID: ",n?n.driverID:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Number of Seats: ",n?n.numberOfseats:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Status: ",n?n.status:"N/A"]})]})]})},yt=()=>{const[n,t]=i.useState([]),s=M.getInstance(),[o,a]=i.useState(),[c,r]=i.useState("");i.useRef(null),i.useRef(null),i.useEffect(()=>{(async()=>{const u=await s.getShuttles(c);t(u)})()},[c]),i.useEffect(()=>{console.log(o)},[o]);function l(d){a(s.getShuttleByID(d))}return e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(v,{children:"Shuttles"})}),e.jsx(L,{slot:"End",children:e.jsx(I,{routerLink:"AdminAddShuttle",children:"ADD"})}),e.jsx(p,{children:e.jsx(se,{onIonChange:d=>r(d.detail.value?d.detail.value:"")})})]}),e.jsx(C,{id:"open-AddShuttleModal",inset:!0,children:n.map(d=>e.jsx(S,{button:!0,onClick:()=>l(d.shuttleID),children:e.jsx(g,{children:d.shuttleName})},d.shuttleID))}),e.jsx(wt,{shuttle:o})]})},Nt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Shuttles"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(yt,{})})]}),e.jsx(G,{})]}),At=({user:n})=>{const t=i.useRef(null);i.useRef(null);const[s,o]=i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function a(){var r;(r=t.current)==null||r.dismiss(null,"confirm")}function c(r){r.detail.role==="confirm"&&o("Hello, ".concat(r.detail.data,"!"))}return e.jsx("div",{children:e.jsxs(te,{ref:t,trigger:"open-AddUserModal",onWillDismiss:r=>c(r),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var r;return(r=t.current)==null?void 0:r.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Welcome"}),e.jsx(L,{slot:"end",children:e.jsx(I,{strong:!0,onClick:()=>a(),children:"Confirm"})})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["User ID: ",n?n.id:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Name: ",n?n.name:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Email: ",n?n.email:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Password: ",n?n.password:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Role: ",n?n.role:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Status: ",n?n.status:"N/A"]})]})]})})},Rt=()=>{const[n,t]=i.useState([]),[s,o]=i.useState(),[a,c]=i.useState(""),r=w.getInstance();i.useEffect(()=>{t(r.getUsers())},[]);const l=(u,h)=>{const m=r.findUser(u,h);o(m)},d=()=>{const u=r.getUsers().filter(h=>h.name.toLowerCase().includes(a.toLowerCase()));t(u)};return e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(v,{children:"Users"}),e.jsxs(L,{slot:"end",children:[e.jsx(I,{routerLink:"/AdminAddUser",children:"ADD"}),e.jsx(I,{onClick:d,children:"Search"})]})]}),e.jsx(p,{children:e.jsx(se,{value:a,onIonChange:u=>c(u.detail.value),onIonClear:()=>{c(""),t(r.getUsers())},placeholder:"Search by name"})})]}),e.jsx(C,{id:"open-AddUserModal",inset:!0,children:n.map(u=>e.jsx(S,{button:!0,onClick:()=>l(u.email,u.password),children:e.jsx(g,{children:u.name})},u.id))}),s&&e.jsx(At,{user:s})]})},Bt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Users"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Rt,{})})]}),e.jsx(G,{})]}),Tt=()=>{const[n,t]=i.useState(""),[s,o]=i.useState(""),[a,c]=i.useState(""),[r,l]=i.useState(""),[d,u]=i.useState(""),h=w.getInstance(),m=()=>{const j={id:h.generateRandomUserId(),name:n,email:s,password:a,role:r,status:d};h.addUsertoDatabase(j)};return e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Name"}),e.jsx(N,{label:"",value:n,onIonChange:x=>t(x.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Email"}),e.jsx(N,{label:"",value:s,onIonChange:x=>o(x.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Password"}),e.jsx(N,{label:"",type:"password",value:a,onIonChange:x=>c(x.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Role"}),e.jsx(N,{label:"",value:r,onIonChange:x=>l(x.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Status"}),e.jsx(N,{label:"",value:d,onIonChange:x=>u(x.detail.value)})]}),e.jsx(I,{expand:"full",onClick:m,children:"Submit"})]})})},Ct=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Page Title"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Tt,{})})]}),e.jsx(G,{})]}),Et=()=>{const[n,t]=i.useState(0),[s,o]=i.useState(0),[a,c]=i.useState(""),[r,l]=i.useState(""),[d,u]=i.useState(""),h=H.getInstance(),m=async()=>{const j={locationId:h.generateRandomLocationID(),latitude:n,longitude:s,description:a,locationName:r};console.log(j);try{await h.addLocation(j),u("Location added successfully")}catch(k){u(String(k))}};return e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Location Name"}),e.jsx(N,{label:"",value:r,onIonChange:x=>l(x.detail.value)})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Latitude"}),e.jsx(N,{label:"",type:"number",value:n,onIonChange:x=>t(parseFloat(x.detail.value))})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Longitude"}),e.jsx(N,{label:"",type:"number",value:s,onIonChange:x=>o(parseFloat(x.detail.value))})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Description"}),e.jsx(N,{label:"",value:a,onIonChange:x=>c(x.detail.value)})]}),e.jsx(I,{expand:"full",onClick:m,children:"Submit"}),e.jsx("p",{children:d})," "]})},Ht=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Add Location"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Et,{})})]}),e.jsx(G,{})]}),Ut=({location:n})=>{const t=i.useRef(null),s=i.useRef(null),[o,a]=i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function c(){var l,d;(d=t.current)==null||d.dismiss((l=s.current)==null?void 0:l.value,"confirm")}function r(l){l.detail.role==="confirm"&&a("Hello, ".concat(l.detail.data,"!"))}return e.jsxs(te,{ref:t,trigger:"open-AddLocationModal",onWillDismiss:l=>r(l),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var l;return(l=t.current)==null?void 0:l.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Welcome"}),e.jsx(L,{slot:"end",children:e.jsx(I,{strong:!0,onClick:()=>c(),children:"Confirm"})})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["Location ID: ",n?n.locationId:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Location Name: ",n?n.locationName:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Latitude: ",n?n.latitude:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Longitude: ",n?n.longitude:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Description: ",n?n.description:"N/A"]})]})]})},Pt=()=>{const[n,t]=i.useState([]),[s,o]=i.useState(""),a=H.getInstance(),[c,r]=i.useState();i.useRef(null),i.useEffect(()=>{(async()=>{const h=await a.getLocations();t(h)})()},[]),i.useEffect(()=>{console.log(c)},[c]);function l(u){r(a.getLocationByID(u))}const d=n.filter(u=>u.locationName.toLowerCase().includes(s.toLowerCase()));return e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(v,{children:"Locations"})}),e.jsxs(L,{slot:"end",children:[e.jsx(I,{routerLink:"/AdminAddLocation",children:"ADD"})," "]}),e.jsx(p,{children:e.jsx(se,{value:s,onIonChange:u=>o(u.detail.value)})})]}),e.jsx(C,{id:"open-AddLocationModal",inset:!0,children:d.map(u=>e.jsx(S,{button:!0,onClick:()=>l(u.locationId),children:e.jsx(g,{children:u.locationName})},u.locationId))}),c&&e.jsx(Ut,{location:c})," "]})},Ft=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Locations"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Pt,{})})]}),e.jsx(G,{})]});$.accessToken="pk.eyJ1IjoidGhlcmVhbGJvbmdhIiwiYSI6ImNsbG0yMXF2dTJqZm0zZ21nbm43b3RyamYifQ.DeWMvQ5HgM53BMjgWqc2TQ";const Mt=({endLocation:n})=>{function t(){return new Promise((m,x)=>{navigator.geolocation.getCurrentPosition(m,x)})}const s=i.useRef(null),o=i.useRef(null);i.useEffect(()=>{s.current?(o.current=new $.Map({container:s.current,style:"mapbox://styles/mapbox/streets-v11",center:[28.047038,-26.093444],zoom:15}),o.current?(o.current.on("load",()=>{o.current&&o.current.resize()}),o.current.on("resize",()=>{o.current&&o.current.resize()})):console.error("Failed to initialize map: map.current is null")):console.error("Failed to initialize map: mapContainer.current is null")},[]),i.useEffect(()=>{(async()=>{const x=await t(),j={lat:x.coords.latitude,lng:x.coords.longitude};h(j,n)})(),o.current&&o.current.resize()},[n]);const[a,c]=i.useState(-70.9),[r,l]=i.useState(42.35),[d,u]=i.useState(9);i.useState("");async function h(m,x){const j=await t();console.log(j);const k="https://api.mapbox.com/directions/v5/mapbox/driving-traffic/".concat(m.lng,",").concat(m.lat,";").concat(x.longitude,",").concat(x.latitude,"?access_token=").concat($.accessToken,"&geometries=geojson");console.log(k),fetch(k).then(D=>D.json()).then(D=>{D.routes&&D.routes.length?(console.log(D),o.current&&(o.current.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:D.routes[0].geometry}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}}),new $.Marker().setLngLat([m.lng,m.lat]).addTo(o.current),new $.Marker({color:"red"}).setLngLat([x.longitude,x.latitude]).addTo(o.current))):console.error("No route found",D)}).catch(D=>{console.error("Error fetching directions:",D)})}return e.jsxs("div",{children:[e.jsxs("div",{className:"sidebar",children:["Longitude: ",a," | Latitude: ",r," | Zoom: ",d]}),e.jsx("div",{ref:s,className:"map-container"})]})},Ot=()=>{const n=Y.getInstance();return e.jsx(A,{children:e.jsx(Mt,{endLocation:{locationId:0,latitude:n.getTravelEndLocation().latitude,longitude:n.getTravelEndLocation().longitude,description:"",locationName:n.getTravelEndLocation().locationName}})})},$t=({location:n})=>{const t=i.useRef(null),s=i.useRef(null),o=Y.getInstance(),[a,c]=i.useState("This modal example uses triggers to automatically open a modal when the button is clicked.");function r(u){u.detail.role==="confirm"&&c("Hello, ".concat(u.detail.data,"!"))}const l=J(),d=()=>{var u,h;o.setTravelEndLocation(n),l.push("/MapNavigation"),(h=t.current)==null||h.dismiss((u=s.current)==null?void 0:u.value,"confirm")};return e.jsx("div",{children:e.jsxs(te,{ref:t,trigger:"open-ShowLocationModal",onWillDismiss:u=>r(u),children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var u;return(u=t.current)==null?void 0:u.dismiss()},children:"Cancel"})}),e.jsx(v,{children:n==null?void 0:n.locationName})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["Location Name: ",n?n.locationName:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Latitude: ",n?n.latitude:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Longitude: ",n?n.longitude:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Description: ",n?n.description:"N/A"]}),e.jsx(I,{expand:"full",onClick:d,children:"Go To Location"})]})]})})},zt=()=>{const[n,t]=i.useState([]),s=new H,[o,a]=i.useState();i.useEffect(()=>{(async()=>{const l=await s.getLocations();t(l)})()},[]),i.useEffect(()=>{console.log(o)},[o]);function c(r){a(s.getLocationByID(r))}return e.jsxs("div",{children:[e.jsx(C,{id:"open-ShowLocationModal",inset:!0,children:n.map(r=>e.jsx(S,{button:!0,onClick:()=>c(r.locationId),children:e.jsx(g,{children:r.locationName})},r.locationId))}),e.jsx($t,{location:o})]})},Gt=()=>e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-studentcontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Locations"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(zt,{})})]}),e.jsx(ce,{})]}),Wt=()=>{const[n,t]=i.useState(0),[s,o]=i.useState(""),[a,c]=i.useState(""),[r,l]=i.useState(""),d=z.getInstance(),u=()=>{const h={scheduleID:n,scheduleName:s,startTime:new Date(a),endTime:new Date(r)};d.addSchedulesToDataBAse(h).then(()=>console.log("Schedule added successfully"))};return e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Schedule ID"}),e.jsx(N,{value:n,onIonChange:h=>t(Number(h.detail.value))})]}),e.jsxs(S,{children:[e.jsx(g,{position:"stacked",children:"Schedule Name"}),e.jsx(N,{value:s,onIonChange:h=>o(h.detail.value)})]}),e.jsx(g,{position:"stacked",children:"Start Time"}),e.jsx(S,{children:e.jsx(Ie,{presentation:"time",value:a,onIonChange:h=>c(Array.isArray(h.detail.value)?h.detail.value[0]:h.detail.value)})}),e.jsx(g,{position:"stacked",children:"End Time"}),e.jsx("br",{}),e.jsx(S,{children:e.jsx(Ie,{presentation:"time",value:r,onIonChange:h=>l(Array.isArray(h.detail.value)?h.detail.value[0]:h.detail.value)})}),e.jsx(I,{expand:"full",onClick:u,children:"Submit"})]})},Yt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Page Title"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Wt,{})})]}),e.jsx(G,{})]}),Jt=({schedule:n})=>{const t=i.useRef(null);return e.jsxs(te,{ref:t,trigger:"open-AddScheduleModal",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(I,{onClick:()=>{var s;return(s=t.current)==null?void 0:s.dismiss()},children:"Cancel"})}),e.jsx(v,{children:"Schedule Details"})]})}),e.jsxs(b,{className:"ion-padding",children:[e.jsxs(g,{children:["Schedule ID: ",n?n.scheduleID:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Schedule Name: ",n?n.scheduleName:"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["Start Time: ",n?new Date(n.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"]}),e.jsx("br",{}),e.jsxs(g,{children:["End Time: ",n?new Date(n.endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"]}),e.jsx("br",{})]})]})},Qt=()=>{const[n,t]=i.useState([]),s=z.getInstance(),[o,a]=i.useState(),[c,r]=i.useState("");i.useEffect(()=>{(async()=>{const u=await s.getSchedules(c);t(u)})()},[c]),i.useEffect(()=>{console.log(o)},[o]);function l(d){a(s.getScheduleByID(d))}return e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(v,{children:"Schedules"})}),e.jsxs(L,{slot:"end",children:[e.jsx(I,{routerLink:"/AdminAddSchedules",children:"ADD"})," "]}),e.jsx(p,{children:e.jsx(se,{onIonChange:d=>r(d.detail.value?d.detail.value:"")})})]}),e.jsx(C,{id:"open-AddScheduleModal",inset:!0,children:n.map(d=>e.jsx(S,{button:!0,onClick:()=>l(d.scheduleID),children:e.jsx(g,{children:d.scheduleName})},d.scheduleID))}),o&&e.jsx(Jt,{schedule:o})," "]})},Zt=()=>w.getInstance().getLoggedRole()!=="admin"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Page Title"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Qt,{})})]}),e.jsx(G,{})]}),qt=({startLocationId:n,endLocationId:t})=>{const[s,o]=i.useState([]),a=U.getInstance(),c=H.getInstance();return w.getInstance(),i.useState([]),i.useEffect(()=>{o(a.getRoutesByStartAndEndLocation(n,t))},[n,t]),e.jsx("div",{className:"ion-padding",children:e.jsx(C,{children:s.map(r=>{var l,d;return e.jsxs(S,{children:[e.jsx(g,{children:r.driverName}),e.jsxs(g,{children:[(l=c.getLocationByID(r.startLocationID))==null?void 0:l.locationName,"--to--",(d=c.getLocationByID(r.endLocationID))==null?void 0:d.locationName]}),e.jsxs(g,{children:["Leaving at ,",new Date(r.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},r.driverRouteID)})})})},Kt=()=>{const[n,t]=i.useState(null),[s,o]=i.useState(null);return e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-studentcontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Trips"})]})}),e.jsxs(b,{className:"ion-padding",children:["Start Location",e.jsx(W,{onLocationSelect:t}),"End Location",e.jsx(W,{onLocationSelect:o}),"Trips",e.jsx(qt,{startLocationId:n||1,endLocationId:s||2})]})]}),e.jsx(ce,{})]})},Vt=()=>{const[n,t]=i.useState(),[s,o]=i.useState(),[a,c]=i.useState(),r=w.getInstance(),[l,d]=i.useState(),[u,h]=i.useState(),m=J(),x=R=>{t(R.detail.value)},j=R=>{o(R.detail.value)},k=R=>{c(R.detail.value)},D=R=>{if(R.preventDefault(),d(void 0),h(void 0),!s||!a||!n){d("Username and password or name cannot be empty");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(a)){h("Password must be longer than 8 characters and contain at least 1 uppercase letter, 1 lowercase letter, and 1 number");return}const O=/^(\b(ALTER|CREATE|DELETE|DROP|EXEC(UTE){0,1}|INSERT( INTO){0,1}|MERGE|SELECT|UPDATE|UNION( ALL){0,1})\b)|(\%27)/;if(O.test(s)||O.test(a)){d("Invalid characters detected"),h("Invalid characters detected");return}const ne={id:r.generateRandomUserId(),name:n,email:s,password:a,role:"user",status:"active"};r.addUsertoDatabase(ne),m.push("/")};return e.jsxs("div",{children:[e.jsx("h4",{className:"ion-text-center ion-margin-top",children:"VC Shuttle"}),e.jsx("form",{onSubmit:D,children:e.jsx(De,{children:e.jsx(ve,{className:"ion-justify-content-center ion-align-items-center",style:{height:"10%"},children:e.jsxs(Le,{size:"12",sizeMd:"6",sizeLg:"4",sizeXl:"3",children:[e.jsx("div",{className:"ion-text-center ion-padding",children:e.jsx("img",{src:Ee,alt:"Place holder logo",width:"50%"})}),e.jsx(N,{className:"ion-margin-top",label:"Name","label-placement":"floating",type:"text",fill:"outline",placeholder:"Enter Name",value:n,onIonChange:x}),e.jsx(N,{className:"ion-margin-top",label:"Email","label-placement":"floating",type:"email",fill:"outline",placeholder:"Enter email",value:s,onIonChange:j}),l&&e.jsx("p",{children:l}),e.jsx(N,{className:"ion-margin-top",label:"Password","label-placement":"floating",type:"password",fill:"outline",placeholder:"Enter Password",value:a,onIonChange:k}),u&&e.jsx("p",{children:u}),e.jsx(I,{className:"ion-margin-top",type:"submit",expand:"block",children:"Register"}),e.jsx(I,{className:"ion-margin-top",routerLink:"/",expand:"block",children:"Log In"})]})})})})]})},Xt=()=>e.jsxs(A,{children:[e.jsx(f,{children:e.jsx(p,{children:e.jsx(v,{children:"Register Page"})})}),e.jsx(b,{className:"ion-padding",children:e.jsx(Vt,{})})]}),_t=()=>{const[n,t]=i.useState(""),[s,o]=i.useState([]),a=ge.getInstance();i.useEffect(()=>{(async()=>{const l=await a.getReviewByUsername(n);o(l)})()},[]);const c=async()=>{try{const r=await a.getReviewByUsername(n);o(r)}catch(r){console.error("Error fetching reviews:",r)}};return e.jsxs("div",{children:[e.jsxs(S,{children:[e.jsx(g,{position:"stacked",style:{fontSize:25},children:"Search Username"}),e.jsx(N,{label:"",value:n,onIonChange:r=>t(r.detail.value)})]}),e.jsx(I,{expand:"full",onClick:c,children:"Search"}),s.map(r=>e.jsxs("div",{children:[e.jsx("h2",{children:r.username}),e.jsxs("p",{children:["Stars: ",r.stars]}),e.jsxs("p",{children:["Shuttle: ",r.shuttle]}),e.jsxs("p",{children:["Description: ",r.description]})]},r.reviewId))]})},es=()=>e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-content",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Reviews Page"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(_t,{})})]}),e.jsx(G,{})]}),ts=()=>{const n=E.getInstance();w.getInstance();const t=z.getInstance(),s=M.getInstance(),[o,a]=i.useState([]);H.getInstance();const[c,r]=i.useState("");return i.useEffect(()=>{(async()=>{o.length<=0&&await n.fetchBookings();const d=await n.getAllRecentBookingsByShuttleID(s.getSelectedShuttle(),c);a(d)})()},[c]),e.jsxs("div",{children:[e.jsxs(f,{children:[e.jsx(p,{children:e.jsx(v,{children:"Recent Bookings"})}),e.jsx(p,{children:e.jsx(se,{onIonChange:l=>r(l.detail.value?l.detail.value:"")})})]}),e.jsx(C,{children:o.map(l=>{var d;return e.jsxs(S,{button:!0,children:[e.jsx(g,{children:l.userId}),e.jsx(g,{children:(d=t.getScheduleByID(l.session))==null?void 0:d.scheduleName})]},l.bookingid)})})]})},ss=()=>w.getInstance().getLoggedRole()!=="driver"?e.jsx(P,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"main-Drivercontent",children:[e.jsx(f,{children:e.jsxs(p,{children:[e.jsx(L,{slot:"start",children:e.jsx(B,{})}),e.jsx(v,{children:"Bookings"})]})}),e.jsx(b,{className:"ion-padding",children:e.jsx(ts,{})})]}),e.jsx(pe,{})]});Ye();const ns=()=>e.jsx(Je,{children:e.jsx(Qe,{children:e.jsxs(Ze,{children:[e.jsx(y,{exact:!0,path:"/",children:e.jsx(Ve,{})}),e.jsx(y,{exact:!0,path:"/StudentHome",children:e.jsx(it,{})}),e.jsx(y,{exact:!0,path:"/DriverCreateRoute",children:e.jsx(pt,{})}),e.jsx(y,{exact:!0,path:"/DriverHomePage",children:e.jsx(ht,{})}),e.jsx(y,{exact:!0,path:"/DriverBookingPage",children:e.jsx(ss,{})}),e.jsx(y,{exact:!0,path:"/AdminHomePage",children:e.jsx(St,{})}),e.jsx(y,{exact:!0,path:"/ShuttleBooking",children:e.jsx(rt,{})}),e.jsx(y,{exact:!0,path:"/StudentBookingList",children:e.jsx(lt,{})}),e.jsx(y,{exact:!0,path:"/StudentMap",children:e.jsx(mt,{})}),e.jsx(y,{exact:!0,path:"/AdminBooking",children:e.jsx(Dt,{})}),e.jsx(y,{exact:!0,path:"/AdminShuttle",children:e.jsx(Nt,{})}),e.jsx(y,{exact:!0,path:"/AdminUsers",children:e.jsx(Bt,{})}),e.jsx(y,{exact:!0,path:"/AdminLocations",children:e.jsx(Ft,{})}),e.jsx(y,{exact:!0,path:"/AdminSchedules",children:e.jsx(Zt,{})}),e.jsx(y,{exact:!0,path:"/AdminAddBooking",children:e.jsx(Lt,{})}),e.jsx(y,{exact:!0,path:"/AdminAddShuttle",children:e.jsx(bt,{})}),e.jsx(y,{exact:!0,path:"/AdminAddUser",children:e.jsx(Ct,{})}),e.jsx(y,{exact:!0,path:"/AdminAddLocation",children:e.jsx(Ht,{})}),e.jsx(y,{exact:!0,path:"/AdminAddSchedules",children:e.jsx(Yt,{})}),e.jsx(y,{exact:!0,path:"/MapNavigation",children:e.jsx(Ot,{})}),e.jsx(y,{exact:!0,path:"/LocationsList",children:e.jsx(Gt,{})}),e.jsx(y,{exact:!0,path:"/StudentScheduledTrips",children:e.jsx(Kt,{})}),e.jsx(y,{exact:!0,path:"/StudentRegister",children:e.jsx(Xt,{})}),e.jsx(y,{exact:!0,path:"/Reviews",children:e.jsx(es,{})})]})})}),os=document.getElementById("root"),as=ze(os);as.render(e.jsx($e.StrictMode,{children:e.jsx(ns,{})}));export{rs as __vite_legacy_guard};
